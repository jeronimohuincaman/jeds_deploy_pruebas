"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[392],{2392:(K,P,a)=>{a.r(P),a.d(P,{ProveedoresModule:()=>V});var v=a(1531),p=a(4755),x=a(3627),m=a(1728),u=a(5580),N=a(787),f=a(9114),r=a(9401),S=a(9609),U=a(5971),L=a(3686),h=a(430),g=a(6375),A=a(3649),e=a(2223),w=a(8372),z=a(1884),Z=a(5861),F=a(3905),J=a(8675),R=a(4004),d=a(2340),M=a(7579),Y=a(3144);let b=(()=>{class i{constructor(o){this.http=o}getProveedores(o){let t="?";t+="desc"==o?.sort?"sort=-RazonSocial&":"",t+=o?.pagination?"pagination=1&":"",t+=o?.perpage?"per-page="+o.perpage+"&":"",t+=o?.currentPage?"page="+o.currentPage+"&":"";var n=new M.x;return this.http.get(`${d.N.administracion.view_proveedores}${t}`,{observe:"response"}).subscribe(l=>{n.next({list:l.body,totalPages:l.headers.get("x-pagination-page-count"),totalCount:l.headers.get("x-pagination-total-count")})}),n.asObservable()}getProveedor(o){return this.http.get(`${d.N.administracion.view_proveedores}/${o}`)}getLocalidades(o){return this.http.get(`${d.N.localidades}${o} `)}saveProveedor(o){return this.http.post(`${d.N.administracion.proveedores}`,o)}updateProveedor(o){return this.http.put(`${d.N.administracion.proveedores}/`+o.Codigo,o)}deleteProveedor(o){return this.http.delete(d.N.administracion.proveedores+"/"+o)}}return i.\u0275fac=function(o){return new(o||i)(e.LFG(Y.eN))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})();var D=a(1217),C=a(8995);function E(i,s){if(1&i&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&i){const o=s.$implicit;e.Q6J("value",o),e.xp6(1),e.AsE(" ",o.descripcion," - ",o.provincia0.descripcion," ")}}let y=(()=>{class i{constructor(o,t,n,l){this.data=o,this.proveedoresService=t,this.alert=n,this.dialogRef=l,this.columns=["cuit","razon_social","direccion","localidad","telefono","email","contacto","numero_contacto","acciones"],this.localidades=[],this.proveedor=this.data?this.data:null,this.title=this.proveedor?.Codigo?"Editar Proveedor":"Nuevo Proveedor"}ngOnInit(){this.newForm(),this.getLocalidades()}newForm(){this.form=new r.cw({cuit:new r.NI(this.proveedor?this.proveedor.cuit:"",[r.kI.required,r.kI.maxLength(11),r.kI.minLength(11)]),razon_social:new r.NI(this.proveedor?this.proveedor.RazonSocial:"",[r.kI.required]),direccion:new r.NI(this.proveedor?this.proveedor.Direccion:"",r.kI.required),localidad:new r.NI("",r.kI.required),email:new r.NI(this.proveedor?this.proveedor.Mail:"",[r.kI.email]),telefono:new r.NI(this.proveedor?this.proveedor.telefono:""),contacto:new r.NI(this.proveedor?this.proveedor.contacto:""),mail_alternativo:new r.NI(this.proveedor?.mail_alternativo?this.proveedor.mail_alternativo:""),activo:new r.NI(this.proveedor?this.proveedor.activo?1:0:"")})}getLocalidades(){var o=this;return(0,Z.Z)(function*(){const n=yield(0,F.z)(o.proveedoresService.getLocalidades("?expand=provincia0"));yield o.getDataLocalidades(n)})()}getDataLocalidades(o){var t=this;return(0,Z.Z)(function*(){new Promise(function(){var n=(0,Z.Z)(function*(l){if(t.localidades=o,t.filteredLocalidades=t.form.get("localidad").valueChanges.pipe((0,J.O)(""),(0,R.U)(c=>t._filterLocalidades(c))),t.proveedor&&t.localidades){const c=t.localidades.filter(T=>T.codigo==t.proveedor.Localidad);t.form.get("localidad").setValue(c[0])}l(!0)});return function(l){return n.apply(this,arguments)}}())})()}_filterLocalidades(o){const t=o.toString().toLowerCase();return this.localidades.filter(n=>n.descripcion.toLowerCase().includes(t))}getTextLocalidad(o){return o?o.descripcion+" - "+o.provincia0.descripcion:""}onSubmit(){if(!this.form.valid)return this.alert.warning("Revise Los Datos Ingresados");this.proveedor={...this.proveedor,RazonSocial:this.form.get("razon_social").value,Localidad:this.form.get("localidad").value.codigo,cuit:this.form.get("cuit").value,Direccion:this.form.get("direccion").value,Mail:this.form.get("email").value,telefono:this.form.get("telefono").value,contacto:this.form.get("contacto").value,mail_alternativo:this.form.get("mail_alternativo").value,activo:this.form.get("activo").value},this.proveedor.Codigo?this.proveedoresService.updateProveedor(this.proveedor).subscribe({next:o=>{o&&this.onCloseMenu()}}):this.proveedoresService.saveProveedor(this.proveedor).subscribe({next:o=>{o&&this.onCloseMenu()}})}onCloseMenu(){this.dialogRef.close(!1)}}return i.\u0275fac=function(o){return new(o||i)(e.Y36(u.WI),e.Y36(b),e.Y36(g.T),e.Y36(u.so))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-save-proveedor"]],decls:60,vars:9,consts:[[1,"fixed","inset-0","bg-white","dark:bg-slate-900","shadow-lg","overflow-hidden","overflow-y-auto","sm:rounded-2xl","md:min-w-[50rem]","sm:w-90","sm:min-w-90","flex-col","flex","sm:inset-auto","max-h-screen","sm:static"],[1,"w-full","px-4","py-4","bg-primary","flex","justify-between","items-center"],[1,"text-white","font-bold","text-lg"],["mat-icon-button","",3,"click"],[1,"text-white"],[1,"flex","flex-col","w-full","h-full","p-4","form-menu",3,"formGroup"],[1,"flex","gap-2"],["appearance","outline",1,"w-2/5"],["matInput","","formControlName","cuit"],["appearance","outline",1,"w-3/5"],["matInput","","formControlName","razon_social"],["matInput","","formControlName","direccion"],["type","text","matInput","","formControlName","localidad","formControlName","localidad",3,"matAutocomplete"],["autoActiveFirstOption","",3,"displayWith"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","telefono"],["matInput","","formControlName","email"],["matInput","","formControlName","mail_alternativo"],["matInput","","formControlName","contacto"],["appearance","outline",1,"w-1/5"],["formControlName","activo"],[3,"value"],[1,"w-full","md:flex","justify-center","pb-4","md:px-4"],["mat-raised-button","","color","accent",1,"rounded-sm",3,"click"]],template:function(o,t){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"span",2),e._uU(3),e.qZA(),e.TgZ(4,"div")(5,"button",3),e.NdJ("click",function(){return t.onCloseMenu()}),e.TgZ(6,"mat-icon",4),e._uU(7,"close"),e.qZA()()()(),e.TgZ(8,"form",5)(9,"div",6)(10,"mat-form-field",7)(11,"mat-label"),e._uU(12,"N\xb0 CUIT (ej: 30123456789) "),e.qZA(),e._UZ(13,"input",8),e.qZA(),e.TgZ(14,"mat-form-field",9)(15,"mat-label"),e._uU(16,"Raz\xf3n Social "),e.qZA(),e._UZ(17,"input",10),e.qZA()(),e.TgZ(18,"div",6)(19,"mat-form-field",9)(20,"mat-label"),e._uU(21,"Direcci\xf3n "),e.qZA(),e._UZ(22,"input",11),e.qZA(),e.TgZ(23,"mat-form-field",7)(24,"mat-label"),e._uU(25,"Seleccionar localidad "),e.qZA(),e._UZ(26,"input",12),e.TgZ(27,"mat-autocomplete",13,14),e.YNc(29,E,2,3,"mat-option",15),e.ALo(30,"async"),e.qZA()()(),e.TgZ(31,"div",6)(32,"mat-form-field",7)(33,"mat-label"),e._uU(34,"Telefono (ej: 2995452331)"),e.qZA(),e._UZ(35,"input",16),e.qZA(),e.TgZ(36,"mat-form-field",9)(37,"mat-label"),e._uU(38,"Email"),e.qZA(),e._UZ(39,"input",17),e.qZA()(),e.TgZ(40,"div",6)(41,"mat-form-field",9)(42,"mat-label"),e._uU(43,"Email Alternativo"),e.qZA(),e._UZ(44,"input",18),e.qZA(),e.TgZ(45,"mat-form-field",7)(46,"mat-label"),e._uU(47,"Contacto"),e.qZA(),e._UZ(48,"input",19),e.qZA(),e.TgZ(49,"mat-form-field",20)(50,"mat-label"),e._uU(51,"Activo"),e.qZA(),e.TgZ(52,"mat-select",21)(53,"mat-option",22),e._uU(54,"No"),e.qZA(),e.TgZ(55,"mat-option",22),e._uU(56,"Si"),e.qZA()()()()(),e.TgZ(57,"div",23)(58,"button",24),e.NdJ("click",function(){return t.onSubmit()}),e._uU(59," Guardar "),e.qZA()()()),2&o){const n=e.MAs(28);e.xp6(3),e.Oqu(t.title),e.xp6(5),e.Q6J("formGroup",t.form),e.xp6(18),e.Q6J("matAutocomplete",n),e.xp6(1),e.Q6J("displayWith",t.getTextLocalidad),e.xp6(2),e.Q6J("ngForOf",e.lcZ(30,7,t.filteredLocalidades)),e.xp6(24),e.Q6J("value",0),e.xp6(2),e.Q6J("value",1)}},dependencies:[p.sg,m.lW,m.RK,f.KE,f.hX,N.gD,D.ey,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,S.Nt,h.Hw,C.XC,C.ZL,p.Ov]}),i})();var I=a(2018),O=a(7374),j=a(1683),B=a(8978);let Q=(()=>{class i{constructor(o,t,n,l,c,T,H){this._proveedoresService=o,this._searchService=t,this.dialogo=n,this.confirm=l,this.alert=c,this.router=T,this._headerTextService=H,this.dataSource=new x.by,this.headers=["CUIT","Razon Social","Direcci\xf3n","Localidad","Tel\xe9fono","Email","Contacto","acciones"],this.column_params=["cuit","RazonSocial","Direccion","localidad_descripcion","telefono","Mail","contacto","acciones"],this.funcionesObjeto=null,this.filtroBusqueda="",this.filtersLike=["RazonSocial","cuit"],this.filter={activo:-1},this.extraParams="",this.parametrosActualizados=new e.vpe,this.env=d.N.administracion.view_proveedores+"?sort=Descripcion",this.search=new r.NI(""),this._headerTextService.setTitulo(this.router),this.funcionesObjeto=[{icono:"edit",nombre_boton:"Editar",functionName:"editar"},{icono:"delete",nombre_boton:"Eliminar",functionName:"eliminar"}]}ngOnInit(){this.SearchTextSub$=this._searchService.getSearchText().pipe((0,w.b)(250),(0,z.x)()).subscribe(o=>{this.filtroBusqueda=o,this.tabla.filters(this.filtroBusqueda)})}generarAcciones(o){switch(o.name){case"editar":this.updateProveedor(o);break;case"eliminar":this.deleteProveedor(o)}}saveProveedor(){this.dialogo.open(y,{panelClass:"ayuda-dialog"}).afterClosed().subscribe({next:()=>{this.tabla.filters(this.filtroBusqueda)}})}updateProveedor(o){this.dialogo.open(y,{data:o.params.data,panelClass:"my-dialog",autoFocus:!1}).afterClosed().subscribe({next:()=>{this.tabla.filters(this.filtroBusqueda)}})}deleteProveedor(o){this.confirm.open({title:"Eliminar Proveedor "+o.params.data.RazonSocial,message:"\xbfDesea eliminar la Proveedor: "+o.params.data.RazonSocial+"?",dismissible:!1,actions:{confirm:{show:!0,color:"warn",label:"Si"},cancel:{show:!0,label:"No"}}}).afterClosed().subscribe(t=>{"confirmed"===t&&this._proveedoresService.deleteProveedor(o.params.data.Codigo).subscribe({next:n=>{this.alert.success("Proveedor eliminado con \xe9xito."),t&&this.tabla.renderTabla()},error:n=>{console.error(n),alert("Este Proveedor no puede eliminarse. Tiene elementos asociados.")}})})}ngOnDestroy(){this._searchService.unsubscribe()}}return i.\u0275fac=function(o){return new(o||i)(e.Y36(b),e.Y36(O.o),e.Y36(u.uw),e.Y36(j.R),e.Y36(g.T),e.Y36(v.F0),e.Y36(B.k))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-proveedores"]],viewQuery:function(o,t){if(1&o&&e.Gf(I.C,5),2&o){let n;e.iGM(n=e.CRH())&&(t.tabla=n.first)}},inputs:{extraParams:"extraParams"},outputs:{parametrosActualizados:"parametrosActualizados"},decls:9,vars:9,consts:[[1,"w-full","flex","flex-col","relative"],[1,"mb-8","mt-2"],[1,"fixed","right-10"],["mat-icon-button","","type","button","matTooltip","Crear Medio de cobro",1,"mr-2","ml-2","bg-blue-500","p-2","rounded-full","z-99999",3,"click"],["save",""],[1,"text-white"],[1,"pr-2","pl-2"],[1,"bottom-10","sm:bottom-0","table-fixed","sm:top-2","w-full","m-0",3,"cache","columnsNames","renderType","columnsParams","endpoint","functions","extraClasses","FiltersLikes","extraParams","functionEmitter"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3,4),e.NdJ("click",function(){return t.saveProveedor()}),e.TgZ(5,"mat-icon",5),e._uU(6,"add"),e.qZA()()()(),e.TgZ(7,"div",6)(8,"app-tabla-dinamica",7),e.NdJ("functionEmitter",function(l){return t.generarAcciones(l)}),e.qZA()()()),2&o&&(e.xp6(8),e.Q6J("cache",!1)("columnsNames",t.headers)("renderType","client")("columnsParams",t.column_params)("endpoint",t.env)("functions",t.funcionesObjeto)("extraClasses","td.mat-cell border,td.mat-cell border-slate-400")("FiltersLikes",t.filtersLike)("extraParams",t.extraParams))},dependencies:[m.RK,h.Hw,A.gM,I.C]}),i})();var $=a(3276),G=a(2611),W=a(3873);const X=[{path:"",component:Q}];let V=(()=>{class i{}return i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[b,L.r,g.T],imports:[p.ez,v.Bz.forChild(X),x.p0,m.ot,u.Is,N.LD,f.lN,r.UX,S.c,h.Ps,U.W,A.AV,C.Bb,$.TU,G.JX,W.f,v.Bz]}),i})()}}]);