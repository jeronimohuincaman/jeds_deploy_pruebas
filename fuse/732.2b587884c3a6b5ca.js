"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[732],{9732:(Mt,q,l)=>{l.r(q),l.d(q,{ArticulosModule:()=>St});var C=l(1531),_=l(4755),Q=l(9383),c=l(3627),f=l(1728),v=l(787),p=l(9114),a=l(9401),U=l(9609),D=l(5971),w=l(3686),h=l(430),x=l(6375),S=l(3649),t=l(2223),Y=l(8372),O=l(1884),m=l(5861),N=l(3905),g=l(5580),Z=l(1217),j=l(3611),k=l(8951),d=l(2340),b=l(7579),P=l(3144);let T=(()=>{class i{constructor(e,o){this.http=e,this._authService=o}getArticulos(e){let o="?";o+="desc"==e?"sort=-descripcion":"sort=descripcion";let n=new b.x;return this.http.get(`${d.N.stock.view_articulos}${o}`).subscribe(s=>{this._authService.accessToken=s.token,n.next({list:s.result})}),n.asObservable()}saveArticulo(e){return this.http.post(`${d.N.stock.articulos}`,e)}updateArticulo(e){return this.http.put(`${d.N.stock.articulos}/`+e.idarticulo,e)}deleteArticulo(e){return this.http.delete(d.N.stock.articulos+"/"+e)}deleteUnidadDeMedida(e){return this.http.delete(d.N.stock.articulo_unidad_medidas+"/"+e)}saveUnidadDeMedida(e){return this.http.post(`${d.N.stock.articulo_unidad_medidas}`,e)}getRubros(){let o=new b.x;return this.http.get(`${d.N.stock.rubros}?filter[activo]=1`).subscribe(n=>{o.next({list:n.result})}),o.asObservable()}getUnidadesDeMedidaTable(e){let o=`?filter[idarticulo]=${e.idarticulo}`;o+="&expand=um&sort=factor&";var n=new b.x;return this.http.get(`${d.N.stock.articulo_unidad_medidas}${o}`).subscribe(s=>{n.next({list:s.result})}),n.asObservable()}getUnidadesDeMedida(){let o=new b.x;return this.http.get(`${d.N.stock.unidad_medidas}?filter[activo]=1`).subscribe(n=>{o.next({list:n.result})}),o.asObservable()}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(P.eN),t.LFG(k.e))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})();var J=l(1292),A=l(8280);function R(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"mat-checkbox",11),t.NdJ("change",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.toggleForm("insumo",0))}),t._uU(1,"Insumo"),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("checked",0===(null==e.articulo?null:e.articulo.tipo))}}function $(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"mat-checkbox",11),t.NdJ("change",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.toggleForm("producto",1))}),t._uU(1,"Producto"),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("checked",1===(null==e.articulo?null:e.articulo.tipo))}}function G(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"mat-checkbox",11),t.NdJ("change",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.toggleForm("servicio",2))}),t._uU(1,"Servicio"),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("checked",2===(null==e.articulo?null:e.articulo.tipo))}}function E(i,r){if(1&i&&(t.TgZ(0,"div",9),t.YNc(1,R,2,1,"mat-checkbox",10),t.YNc(2,$,2,1,"mat-checkbox",10),t.YNc(3,G,2,1,"mat-checkbox",10),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.TipoArticulo.includes("insumo")),t.xp6(1),t.Q6J("ngIf",e.TipoArticulo.includes("producto")),t.xp6(1),t.Q6J("ngIf",e.TipoArticulo.includes("servicio"))}}function z(i,r){if(1&i&&(t.TgZ(0,"mat-option",24),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.Q6J("value",e.idrubro),t.xp6(1),t.Oqu(e.descripcion)}}function H(i,r){if(1&i&&(t.TgZ(0,"div",14)(1,"mat-form-field",15)(2,"mat-label"),t._uU(3,"Descripci\xf3n"),t.qZA(),t._UZ(4,"input",16),t.qZA(),t.TgZ(5,"div",17)(6,"mat-form-field",18)(7,"mat-label"),t._uU(8,"C\xf3digo interno"),t.qZA(),t._UZ(9,"input",19),t.qZA(),t.TgZ(10,"mat-form-field",18)(11,"mat-label"),t._uU(12,"Rubro"),t.qZA(),t.TgZ(13,"mat-select",20),t.YNc(14,z,2,2,"mat-option",21),t.qZA()(),t.TgZ(15,"mat-form-field",18)(16,"mat-label"),t._uU(17,"Stock m\xednimo"),t.qZA(),t._UZ(18,"input",22),t.qZA(),t.TgZ(19,"mat-form-field",18)(20,"mat-label"),t._uU(21,"Activo"),t.qZA(),t.TgZ(22,"mat-select",23)(23,"mat-option",24),t._uU(24,"No"),t.qZA(),t.TgZ(25,"mat-option",24),t._uU(26,"Si"),t.qZA()()()()()),2&i){const e=t.oxw(2);t.Q6J("formGroup",e.form),t.xp6(14),t.Q6J("ngForOf",e.rubros),t.xp6(9),t.Q6J("value",0),t.xp6(2),t.Q6J("value",1)}}function B(i,r){if(1&i&&(t.TgZ(0,"mat-option",24),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.Q6J("value",e.idrubro),t.xp6(1),t.Oqu(e.descripcion)}}function K(i,r){1&i&&(t.TgZ(0,"span"),t._uU(1,"$"),t.qZA())}function L(i,r){1&i&&(t.TgZ(0,"span"),t._uU(1,"US"),t.qZA())}function V(i,r){if(1&i&&(t.TgZ(0,"mat-option",24),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.Q6J("value",e.articulo.iva_proveedor),t.xp6(1),t.hij(" ",e.articulo.iva_proveedor,"% ")}}function X(i,r){1&i&&(t.TgZ(0,"span"),t._uU(1,"$"),t.qZA())}function W(i,r){1&i&&(t.TgZ(0,"span"),t._uU(1,"US"),t.qZA())}function tt(i,r){1&i&&(t.ynx(0),t._uU(1,"$"),t.BQk())}function et(i,r){1&i&&(t.ynx(0),t._uU(1,"US"),t.BQk())}function ot(i,r){1&i&&(t.TgZ(0,"span"),t._uU(1,"$"),t.qZA())}function it(i,r){1&i&&(t.TgZ(0,"span"),t._uU(1,"US"),t.qZA())}function at(i,r){if(1&i&&(t.TgZ(0,"mat-option",24),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.Q6J("value",e.articulo.iva_porcentaje),t.xp6(1),t.hij(" ",e.articulo.iva_porcentaje,"% ")}}function nt(i,r){1&i&&(t.TgZ(0,"span"),t._uU(1,"$"),t.qZA())}function rt(i,r){1&i&&(t.TgZ(0,"span"),t._uU(1,"US"),t.qZA())}function lt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",14)(1,"mat-form-field",25)(2,"mat-label"),t._uU(3,"Descripci\xf3n"),t.qZA(),t._UZ(4,"input",16),t.qZA(),t.TgZ(5,"div",26)(6,"mat-form-field",27)(7,"mat-label"),t._uU(8,"C\xf3digo Interno"),t.qZA(),t._UZ(9,"input",19),t.qZA(),t.TgZ(10,"mat-form-field",28)(11,"mat-label"),t._uU(12,"Rubro"),t.qZA(),t.TgZ(13,"mat-select",20),t.YNc(14,B,2,2,"mat-option",21),t.qZA()(),t.TgZ(15,"mat-form-field",27)(16,"mat-label"),t._uU(17,"Stock m\xednimo"),t.qZA(),t._UZ(18,"input",29),t.qZA(),t.TgZ(19,"mat-form-field",30)(20,"mat-label"),t._uU(21,"Activo"),t.qZA(),t.TgZ(22,"mat-select",23)(23,"mat-option",24),t._uU(24,"No"),t.qZA(),t.TgZ(25,"mat-option",24),t._uU(26,"Si"),t.qZA()()(),t.TgZ(27,"mat-form-field",27)(28,"mat-label"),t._uU(29,"Moneda"),t.qZA(),t.TgZ(30,"mat-select",31)(31,"mat-option",24),t._uU(32,"$(pesos)"),t.qZA(),t.TgZ(33,"mat-option",24),t._uU(34,"U$S(dolar)"),t.qZA()()()(),t.TgZ(35,"div",26)(36,"mat-form-field",27)(37,"mat-label"),t._uU(38,"Precio de Costo"),t.qZA(),t.YNc(39,K,2,0,"span",32),t.YNc(40,L,2,0,"span",32),t._UZ(41,"input",33),t.qZA(),t.TgZ(42,"mat-form-field",30)(43,"mat-label"),t._uU(44,"IVA Proveedor"),t.qZA(),t.TgZ(45,"mat-select",34),t.YNc(46,V,2,2,"mat-option",35),t.TgZ(47,"mat-option",24),t._uU(48,"0%"),t.qZA(),t.TgZ(49,"mat-option",24),t._uU(50,"10.5%"),t.qZA(),t.TgZ(51,"mat-option",24),t._uU(52,"21%"),t.qZA(),t.TgZ(53,"mat-option",24),t._uU(54,"27%"),t.qZA()()(),t.TgZ(55,"mat-form-field",30)(56,"mat-label"),t._uU(57,"Flete (%)"),t.qZA(),t.TgZ(58,"div",36)(59,"input",37),t.NdJ("input",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.onInputChange())}),t.qZA(),t.TgZ(60,"span",38),t._uU(61,"%"),t.qZA()()(),t.TgZ(62,"mat-form-field",27)(63,"mat-label"),t._uU(64,"Flete (Importe)"),t.qZA(),t.YNc(65,X,2,0,"span",32),t.YNc(66,W,2,0,"span",32),t.TgZ(67,"input",39),t.NdJ("input",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.onInputChange())}),t.qZA()(),t.TgZ(68,"mat-form-field",30)(69,"mat-label"),t._uU(70,"Utilidad"),t.qZA(),t.TgZ(71,"div",36)(72,"input",40),t.NdJ("input",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.onInputChange())}),t.qZA(),t.TgZ(73,"span",38),t._uU(74,"%"),t.qZA()()()(),t.TgZ(75,"div",26)(76,"div",41)(77,"mat-label",42),t._uU(78,"Neto Sugerido"),t.qZA(),t.TgZ(79,"div",43)(80,"span",44),t.YNc(81,tt,2,0,"ng-container",32),t.YNc(82,et,2,0,"ng-container",32),t.qZA(),t.TgZ(83,"span",44),t._uU(84,"-"),t.qZA(),t.TgZ(85,"span",44),t._uU(86),t.qZA()()(),t.TgZ(87,"mat-form-field",27)(88,"mat-label"),t._uU(89,"Precio Neto Final"),t.qZA(),t.YNc(90,ot,2,0,"span",32),t.YNc(91,it,2,0,"span",32),t.TgZ(92,"input",45),t.NdJ("input",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.onInputChange())}),t.qZA()(),t.TgZ(93,"mat-form-field",30)(94,"mat-label"),t._uU(95,"IVA"),t.qZA(),t.TgZ(96,"mat-select",46),t.NdJ("selectionChange",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.onInputChange())}),t.YNc(97,at,2,2,"mat-option",35),t.TgZ(98,"mat-option",24),t._uU(99,"0%"),t.qZA(),t.TgZ(100,"mat-option",24),t._uU(101,"10.5%"),t.qZA(),t.TgZ(102,"mat-option",24),t._uU(103,"21%"),t.qZA(),t.TgZ(104,"mat-option",24),t._uU(105,"27%"),t.qZA()()(),t.TgZ(106,"mat-form-field",27)(107,"mat-label"),t._uU(108,"Precio de Venta"),t.qZA(),t.YNc(109,nt,2,0,"span",32),t.YNc(110,rt,2,0,"span",32),t._UZ(111,"input",47),t.qZA(),t.TgZ(112,"mat-form-field",27)(113,"mat-label"),t._uU(114,"Fecha Actualizacion"),t.qZA(),t._UZ(115,"input",48)(116,"mat-datepicker-toggle",49)(117,"mat-datepicker",null,50),t.qZA()()()}if(2&i){const e=t.MAs(118),o=t.oxw(2);t.Q6J("formGroup",o.form),t.xp6(14),t.Q6J("ngForOf",o.rubros),t.xp6(9),t.Q6J("value",0),t.xp6(2),t.Q6J("value",1),t.xp6(6),t.Q6J("value",0),t.xp6(2),t.Q6J("value",1),t.xp6(6),t.Q6J("ngIf",0===o.form.get("moneda").value),t.xp6(1),t.Q6J("ngIf",1===o.form.get("moneda").value),t.xp6(6),t.Q6J("ngIf",o.articulo),t.xp6(1),t.Q6J("value","0"),t.xp6(2),t.Q6J("value","10.5"),t.xp6(2),t.Q6J("value","21.0"),t.xp6(2),t.Q6J("value","27.0"),t.xp6(12),t.Q6J("ngIf",0===o.form.get("moneda").value),t.xp6(1),t.Q6J("ngIf",1===o.form.get("moneda").value),t.xp6(15),t.Q6J("ngIf",0===o.form.get("moneda").value),t.xp6(1),t.Q6J("ngIf",1===o.form.get("moneda").value),t.xp6(4),t.Oqu(o.form.get("neto_sugerido").value),t.xp6(4),t.Q6J("ngIf",0===o.form.get("moneda").value),t.xp6(1),t.Q6J("ngIf",1===o.form.get("moneda").value),t.xp6(6),t.Q6J("ngIf",o.articulo),t.xp6(1),t.Q6J("value","0"),t.xp6(2),t.Q6J("value","10.5"),t.xp6(2),t.Q6J("value","21.0"),t.xp6(2),t.Q6J("value","27.0"),t.xp6(5),t.Q6J("ngIf",0===o.form.get("moneda").value),t.xp6(1),t.Q6J("ngIf",1===o.form.get("moneda").value),t.xp6(5),t.Q6J("matDatepicker",e)("min",o.minDate)("max",o.maxDate),t.xp6(1),t.Q6J("for",e)}}function st(i,r){if(1&i&&(t.TgZ(0,"mat-option",24),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.Q6J("value",e.idrubro),t.xp6(1),t.Oqu(e.descripcion)}}function ct(i,r){if(1&i&&(t.TgZ(0,"div",14)(1,"mat-form-field",15)(2,"mat-label"),t._uU(3,"Descripci\xf3n"),t.qZA(),t._UZ(4,"input",16),t.qZA(),t.TgZ(5,"div",17)(6,"mat-form-field",18)(7,"mat-label"),t._uU(8,"C\xf3digo interno"),t.qZA(),t._UZ(9,"input",19),t.qZA(),t.TgZ(10,"mat-form-field",18)(11,"mat-label"),t._uU(12,"Rubro"),t.qZA(),t.TgZ(13,"mat-select",20),t.YNc(14,st,2,2,"mat-option",21),t.qZA()(),t.TgZ(15,"mat-form-field",18)(16,"mat-label"),t._uU(17,"Activo"),t.qZA(),t.TgZ(18,"mat-select",23)(19,"mat-option",24),t._uU(20,"No"),t.qZA(),t.TgZ(21,"mat-option",24),t._uU(22,"Si"),t.qZA()()()()()),2&i){const e=t.oxw(2);t.Q6J("formGroup",e.form),t.xp6(14),t.Q6J("ngForOf",e.rubros),t.xp6(5),t.Q6J("value",0),t.xp6(2),t.Q6J("value",1)}}function ut(i,r){if(1&i&&(t.TgZ(0,"form",12),t.YNc(1,H,27,4,"div",13),t.YNc(2,lt,119,31,"div",13),t.YNc(3,ct,23,4,"div",13),t.qZA()),2&i){const e=t.oxw();t.Q6J("formGroup",e.form),t.xp6(1),t.Q6J("ngIf","insumo"===e.selectedOption),t.xp6(1),t.Q6J("ngIf","producto"===e.selectedOption),t.xp6(1),t.Q6J("ngIf","servicio"===e.selectedOption)}}let M=(()=>{class i{constructor(e,o,n,s,u,I){this.data=e,this.authService=o,this.articulosService=n,this.datePipe=s,this.alert=u,this.dialogRef=I,this.columns=["codigo_interno","descripcion","rubro","tipo","activo"],this.selectedOption="",this.TipoArticulo=[],this.articulo=this.data?this.data:null,this.title=this.articulo?.idarticulo?"Editar articulo":"Nuevo articulo",this.minDate=null,this.maxDate=new Date}ngOnInit(){setTimeout(()=>{this.getRubros(),this.authService.verificarDatosEmpresaCargados().subscribe({next:e=>{e&&this.getTipoArticulo()}})})}getTipoArticulo(){var e=this;return(0,m.Z)(function*(){if(e.TipoArticulo=e.authService.tiposArticuloPermitidos,1===e.TipoArticulo.length){const o=e.TipoArticulo[0];"insumo"===o?e.toggleForm("insumo",0):"producto"===o?e.toggleForm("producto",1):"servicio"===o&&e.toggleForm("servicio",2)}else e.articulo&&void 0!==e.articulo.tipo&&(0===e.articulo.tipo?e.toggleForm("insumo",0):1===e.articulo.tipo?e.toggleForm("producto",1):2===e.articulo.tipo&&e.toggleForm("servicio",2))})()}toggleForm(e,o){this.selectedOption=e,0===o?this.form=new a.cw({codigo_interno:new a.NI(this.articulo?this.articulo.codigo_interno:"",a.kI.required),descripcion:new a.NI(this.articulo?this.articulo.descripcion:"",a.kI.required),rubro:new a.NI(this.articulo?this.articulo.idrubro:"",a.kI.required),stock_minimo:new a.NI(this.articulo?this.articulo.stock_minimo:"",[a.kI.required,a.kI.min(0)]),activo:new a.NI(this.articulo?this.articulo?.activo?1:0:"",a.kI.required)}):1===o?this.form=new a.cw({codigo_interno:new a.NI(this.articulo?this.articulo.codigo_interno:"",a.kI.required),descripcion:new a.NI(this.articulo?this.articulo.descripcion:"",a.kI.required),rubro:new a.NI(this.articulo?this.articulo.idrubro:"",a.kI.required),stock_minimo:new a.NI(this.articulo?this.articulo.stock_minimo:"",[a.kI.required,a.kI.min(0)]),activo:new a.NI(this.articulo?this.articulo?.activo?1:0:"",a.kI.required),moneda:new a.NI(this.articulo?this.articulo?.moneda?1:0:"",a.kI.required),precio_costo:new a.NI(this.articulo?this.articulo.costo:"",a.kI.required),iva_proveedor:new a.NI(this.articulo?this.articulo.iva_proveedor:"",a.kI.required),flete_porcentaje:new a.NI(this.articulo?this.articulo.flete_porcentaje:"",a.kI.required),flete_importe:new a.NI(this.articulo?this.articulo.flete_importe:"",a.kI.required),utilidad:new a.NI(this.articulo?this.articulo.utilidad:"",a.kI.required),neto_sugerido:new a.NI(this.articulo?this.articulo.neto_sugerido:"",a.kI.required),neto_final:new a.NI(this.articulo?this.articulo.neto_final:"",a.kI.required),iva_porcentaje:new a.NI(this.articulo?this.articulo.iva_porcentaje:"",a.kI.required),bruto_sugerido:new a.NI(this.articulo?this.articulo.bruto_sugerido:"",a.kI.required),fecha_actualizacion:new a.NI(this.datePipe.transform(this.articulo?.fecha_actualizacion?this.articulo.fecha_actualizacion:new Date,"yyyy-MM-dd"),[a.kI.required])}):2===o&&(this.form=new a.cw({codigo_interno:new a.NI(this.articulo?this.articulo.codigo_interno:"",a.kI.required),descripcion:new a.NI(this.articulo?this.articulo.descripcion:"",a.kI.required),rubro:new a.NI(this.articulo?this.articulo.idrubro:"",a.kI.required),activo:new a.NI(this.articulo?this.articulo?.activo?1:0:"",a.kI.required)}))}getRubros(){var e=this;return(0,m.Z)(function*(){const o=yield(0,N.z)(e.articulosService.getRubros());e.getDataRubros(o)})()}getDataRubros(e){var o=this;return(0,m.Z)(function*(){new Promise(function(){var n=(0,m.Z)(function*(s){o.rubros=e.list,s(!0)});return function(s){return n.apply(this,arguments)}}())})()}calcularImporteFlete(){const e=this.form.get("precio_costo").value,o=this.form.get("iva_proveedor").value,n=this.form.get("flete_porcentaje").value,s=this.form.get("flete_importe").value;null!==n&&""!==n?this.form.patchValue({flete_importe:e*(1+o/100)*(n/100)}):null!==s&&""!==s&&this.form.patchValue({flete_porcentaje:null})}calcularNetoSugerido(){const u=((this.form.get("precio_costo").value*(1+this.form.get("iva_proveedor").value/100)+this.form.get("flete_importe").value)*(1+this.form.get("utilidad").value/100)).toFixed(2);this.form.patchValue({neto_sugerido:u})}calcularPrecioVentaSugerido(){const n=(this.form.get("neto_final").value*(1+this.form.get("iva_porcentaje").value/100)).toFixed(2);this.form.patchValue({bruto_sugerido:n})}onInputChange(){this.calcularImporteFlete(),this.calcularNetoSugerido(),this.calcularPrecioVentaSugerido()}onSubmit(){if(!this.form.valid)return this.alert.warning("Revise Los Datos Ingresados");if("insumo"===this.selectedOption)this.articulo={...this.articulo,codigo_interno:this.form.get("codigo_interno").value.toUpperCase(),descripcion:this.form.get("descripcion").value,idrubro:this.form.get("rubro").value,stock_minimo:this.form.get("stock_minimo").value,activo:this.form.get("activo").value,tipo:0};else if("producto"===this.selectedOption){const e=this.form.get("fecha_actualizacion").value,o=this.datePipe.transform(`${e}`,"yyyy-MM-dd");this.articulo={...this.articulo,codigo_interno:this.form.get("codigo_interno").value.toUpperCase(),descripcion:this.form.get("descripcion").value,idrubro:this.form.get("rubro").value,stock_minimo:this.form.get("stock_minimo").value,activo:this.form.get("activo").value,tipo:1,moneda:this.form.get("moneda").value,costo:this.form.get("precio_costo").value,iva_proveedor:this.form.get("iva_proveedor").value,flete_porcentaje:this.form.get("flete_porcentaje").value,flete_importe:this.form.get("flete_importe").value,utilidad:this.form.get("utilidad").value,neto_sugerido:this.form.get("neto_sugerido").value,neto_final:this.form.get("neto_final").value,iva_porcentaje:this.form.get("iva_porcentaje").value,bruto_sugerido:this.form.get("bruto_sugerido").value,fecha_actualizacion:o}}else"servicio"===this.selectedOption&&(this.articulo={...this.articulo,codigo_interno:this.form.get("codigo_interno").value.toUpperCase(),descripcion:this.form.get("descripcion").value,idrubro:this.form.get("rubro").value,activo:this.form.get("activo").value,tipo:2});this.articulo.idarticulo?this.articulosService.updateArticulo(this.articulo).subscribe({next:e=>{e&&this.onCloseMenu()}}):this.articulosService.saveArticulo(this.articulo).subscribe({next:e=>{e&&this.onCloseMenu()}})}onCloseMenu(){this.dialogRef.close(!1)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(g.WI),t.Y36(k.e),t.Y36(T),t.Y36(_.uU),t.Y36(x.T),t.Y36(g.so))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-save-articulos"]],features:[t._Bn([{provide:Z.sG,useValue:j.x}])],decls:13,vars:3,consts:[[1,"fixed","inset-0","sm:static","max-h-screen","sm:inset-auto","flex","flex-col","sm:min-w-200","sm:w-140","sm:rounded-2xl","overflow-y-auto","overflow-hidden","shadow-lg","bg-white","dark:bg-slate-900"],[1,"w-full","px-4","py-4","bg-primary","flex","justify-between","items-center"],[1,"text-white","font-bold","text-lg"],["mat-icon-button","",3,"click"],[1,"text-white"],["class","flex flex-row w-full h-full p-4",4,"ngIf"],["class","form-menu p-4",3,"formGroup",4,"ngIf"],[1,"w-full","md:flex","justify-center","pb-4","md:px-4"],["mat-raised-button","","color","accent",1,"w-full","bg-primary","rounded-none","md:w-28","md:rounded-3xl","py-8","md:py-0",3,"click"],[1,"flex","flex-row","w-full","h-full","p-4"],[3,"checked","change",4,"ngIf"],[3,"checked","change"],[1,"form-menu","p-4",3,"formGroup"],["class","flex flex-col w-full h-full p-4",3,"formGroup",4,"ngIf"],[1,"flex","flex-col","w-full","h-full","p-4",3,"formGroup"],["appearance","outline",1,"w-full"],["matInput","","formControlName","descripcion"],[1,"flex","gap-1"],["appearance","outline",1,"w-1/2"],["matInput","","formControlName","codigo_interno"],["formControlName","rubro"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","number","formControlName","stock_minimo"],["formControlName","activo"],[3,"value"],[1,"w-full"],[1,"flex","gap-4","mt-4"],[1,"w-1/2"],[1,"w-2/3"],["matInput","","type","number","formControlName","stock_minimo",1,"input-suffix"],[1,"w-1/3"],["formControlName","moneda"],[4,"ngIf"],["matInput","","formControlName","precio_costo"],["formControlName","iva_proveedor"],[3,"value",4,"ngIf"],[1,"input-with-suffix"],["matInput","","formControlName","flete_porcentaje",3,"input"],[1,"suffix"],["matInput","","formControlName","flete_importe",3,"input"],["matInput","","formControlName","utilidad",3,"input"],[1,"flex","flex-col","items-center"],[1,"mb-2"],[1,"flex","gap-1","items-center","mt-3"],[1,"text-xl","font-bold","text-black"],["matInput","","formControlName","neto_final",3,"input"],["formControlName","iva_porcentaje",3,"selectionChange"],["matInput","","formControlName","bruto_sugerido"],["matInput","","formControlName","fecha_actualizacion",3,"matDatepicker","min","max"],["matSuffix","",3,"for"],["picker",""]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"span",2),t._uU(3),t.qZA(),t.TgZ(4,"div")(5,"button",3),t.NdJ("click",function(){return o.onCloseMenu()}),t.TgZ(6,"mat-icon",4),t._uU(7,"close"),t.qZA()()()(),t.YNc(8,E,4,3,"div",5),t.YNc(9,ut,4,4,"form",6),t.TgZ(10,"div",7)(11,"button",8),t.NdJ("click",function(){return o.onSubmit()}),t._uU(12," Guardar "),t.qZA()()()),2&e&&(t.xp6(3),t.Oqu(o.title),t.xp6(5),t.Q6J("ngIf",o.TipoArticulo.length>1),t.xp6(1),t.Q6J("ngIf",""!==o.selectedOption))},dependencies:[_.sg,_.O5,f.lW,f.RK,p.KE,p.hX,p.R9,v.gD,Z.ey,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.sg,a.u,U.Nt,h.Hw,J.oG,A.Mq,A.hl,A.nW],styles:[".input-suffix[_ngcontent-%COMP%]{text-align:right}.input-with-suffix[_ngcontent-%COMP%]{position:relative}.input-with-suffix[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-right:22px;text-align:right}.input-with-suffix[_ngcontent-%COMP%]   .suffix[_ngcontent-%COMP%]{position:absolute;right:10px;top:50%;transform:translateY(-50%)}"]}),i})();var F=l(1683);function mt(i,r){if(1&i&&(t.TgZ(0,"mat-option",22),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.Q6J("value",e.idunidadmedida),t.xp6(1),t.hij(" ",e.descripcion," ")}}function dt(i,r){1&i&&(t.TgZ(0,"th",23),t._uU(1," Unidad de Medida"),t.qZA())}function ft(i,r){if(1&i&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.xp6(1),t.hij(" ",e.um.descripcion," ")}}function pt(i,r){1&i&&(t.TgZ(0,"th",23),t._uU(1,"Factor"),t.qZA())}function _t(i,r){if(1&i&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&i){const e=r.$implicit;t.xp6(1),t.hij(" ",e.factor," ")}}function ht(i,r){1&i&&(t.TgZ(0,"th",23),t._uU(1,"Acciones"),t.qZA())}function gt(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"td",24)(1,"button",3,25),t.NdJ("click",function(){const s=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.deleteUnidadDeMedida(s))}),t.TgZ(3,"mat-icon",26),t._uU(4,"delete"),t.qZA()()()}}function vt(i,r){1&i&&t._UZ(0,"tr",27)}function xt(i,r){1&i&&t._UZ(0,"tr",28)}let Zt=(()=>{class i{constructor(e,o,n,s,u){this.data=e,this.articulosService=o,this.alert=n,this.dialogRef=s,this.confirm=u,this.columns=["descripcion","factor","acciones"],this.dataSource=new c.by,this.articulo=this.data?this.data:null,this.title=`UM de: ${this.articulo.descripcion} `}ngOnInit(){this.newForm(),this.getUnidadesDeMedida(),this.getUnidadesDeMedidaTable()}newForm(){this.form=new a.cw({unidad_medida:new a.NI("",a.kI.required),factor:new a.NI("",[a.kI.required,a.kI.min(1),a.kI.pattern("^[0-9]*$")])})}getUnidadesDeMedidaTable(){var e=this;return(0,m.Z)(function*(){const o=yield(0,N.z)(e.articulosService.getUnidadesDeMedidaTable(e.articulo));e.getDataUnidadesDeMedidasTable(o)})()}getDataUnidadesDeMedidasTable(e){var o=this;return(0,m.Z)(function*(){new Promise(function(){var n=(0,m.Z)(function*(s){o.unidades_de_medida=e.list,o.dataSource=new c.by(o.unidades_de_medida),s(!0)});return function(s){return n.apply(this,arguments)}}())})()}getUnidadesDeMedida(){var e=this;return(0,m.Z)(function*(){const o=yield(0,N.z)(e.articulosService.getUnidadesDeMedida());e.getDataUnidadeDeMedida(o)})()}getDataUnidadeDeMedida(e){var o=this;return(0,m.Z)(function*(){new Promise(function(){var n=(0,m.Z)(function*(s){o.um=e.list,s(!0)});return function(s){return n.apply(this,arguments)}}())})()}deleteUnidadDeMedida(e){this.confirm.open({title:"Eliminar UM "+e.um.descripcion,message:"\xbfDesea eliminar la UM: "+e.um.descripcion+"?",dismissible:!1,actions:{confirm:{show:!0,color:"warn",label:"Si"},cancel:{show:!0,label:"No"}}}).afterClosed().subscribe(o=>{"confirmed"===o&&this.articulosService.deleteUnidadDeMedida(e.idarticulounidadmedida).subscribe({next:n=>{0==n.success?(console.error("No se puede eliminar una UM con factor 1. Elimine las demas UM y vuelva a intentar."),this.alert.error("No puede borrarse UM con factor 1. Elimine las demas UM y vuelva a intentar"),alert("No puede borrarse UM con factor 1. Elimine las demas UM y vuelva a intentar")):(this.alert.success("Articulo eliminado con \xe9xito."),this.getUnidadesDeMedidaTable())},error:n=>{console.error("Error en el servicio:",n),this.alert.error("Error")}})})}onSubmit(){if(!this.form.valid)return this.alert.warning("Revise Los Datos Ingresados");this.articulo_um={...this.articulo_um,idarticulo:this.articulo.idarticulo,idunidadmedida:this.form.get("unidad_medida").value,factor:this.form.get("factor").value},this.articulo_um.idarticulounidadmedida||this.articulosService.saveUnidadDeMedida(this.articulo_um).subscribe({next:e=>{e.success?this.getUnidadesDeMedidaTable():alert("La primera UM debe ser factor 1 y un articulo no puede tener 2 UM del mismo tipo.")}})}onCloseMenu(){this.dialogRef.close(!1)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(g.WI),t.Y36(T),t.Y36(x.T),t.Y36(g.so),t.Y36(F.R))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-modal-unidades-medidas"]],decls:36,vars:7,consts:[[1,"fixed","inset-0","sm:static","max-h-screen","sm:inset-auto","flex","flex-col","sm:min-w-140","sm:w-140","sm:rounded-2xl","overflow-y-auto","shadow-lg","overflow-hidden","bg-white","dark:bg-slate-900"],[1,"w-full","px-4","py-4","bg-primary","flex","justify-between","items-center"],[1,"text-white","font-bold","text-lg"],["mat-icon-button","",3,"click"],[1,"text-white"],[1,"flex","flex-col","w-full","h-full","p-4","shadow-lg",3,"formGroup"],[1,"flex","gap-3"],["appearance","outline",1,"w-1/2"],["formControlName","unidad_medida"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","factor"],[1,"w-1/3","pt-2","text-center"],["mat-mini-fab","","color","primary","aria-label","icon",1,"rounded-full",3,"click"],[1,"px-4","pr-2","pl-2"],["mat-table","",1,"w-full","mt-1","mb-5","shadow-lg",3,"dataSource"],["matColumnDef","descripcion"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","factor"],["matColumnDef","acciones"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"value"],["mat-header-cell",""],["mat-cell",""],["delete",""],["color","warn"],["mat-header-row",""],["mat-row",""]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"span",2),t._uU(3),t.qZA(),t.TgZ(4,"div")(5,"button",3),t.NdJ("click",function(){return o.onCloseMenu()}),t.TgZ(6,"mat-icon",4),t._uU(7,"close"),t.qZA()()()(),t.TgZ(8,"form",5)(9,"div",6)(10,"mat-form-field",7)(11,"mat-label"),t._uU(12,"Unidad de medida"),t.qZA(),t.TgZ(13,"mat-select",8),t.YNc(14,mt,2,2,"mat-option",9),t.qZA()(),t.TgZ(15,"mat-form-field",7)(16,"mat-label"),t._uU(17,"Factor"),t.qZA(),t._UZ(18,"input",10),t.qZA(),t.TgZ(19,"div",11)(20,"button",12),t.NdJ("click",function(){return o.onSubmit()}),t.TgZ(21,"mat-icon"),t._uU(22,"add"),t.qZA()()()()(),t.TgZ(23,"div",13)(24,"table",14),t.ynx(25,15),t.YNc(26,dt,2,0,"th",16),t.YNc(27,ft,2,1,"td",17),t.BQk(),t.ynx(28,18),t.YNc(29,pt,2,0,"th",16),t.YNc(30,_t,2,1,"td",17),t.BQk(),t.ynx(31,19),t.YNc(32,ht,2,0,"th",16),t.YNc(33,gt,5,0,"td",17),t.BQk(),t.YNc(34,vt,1,0,"tr",20),t.YNc(35,xt,1,0,"tr",21),t.qZA()()()),2&e&&(t.xp6(3),t.Oqu(o.title),t.xp6(5),t.Q6J("formGroup",o.form),t.xp6(6),t.Q6J("ngForOf",o.um),t.xp6(10),t.Q6J("dataSource",o.dataSource),t.xp6(10),t.Q6J("matHeaderRowDef",o.columns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",o.columns))},dependencies:[_.sg,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,f.RK,f.nh,p.KE,p.hX,v.gD,Z.ey,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,U.Nt,h.Hw]}),i})();var y=l(2018),bt=l(8288);let Tt=(()=>{class i{constructor(e,o){this.data=e,this.menuService=o}ngOnInit(){this.formFilters=new a.cw({activo:new a.NI(-1),tipo:new a.NI(-1)}),this.formFilters.patchValue(this.data.filter)}resetFilters(){this.formFilters.reset({activo:-1,tipo:-1})}onCloseMenu(e=null){this.menuService.close(e)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36("MENU_DATA"),t.Y36(w.r))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-filter-menu-articulos"]],decls:41,vars:9,consts:[[1,"fixed","filtroJeds","inset-0","sm:static","max-h-screen","sm:inset-auto","flex","flex-col","sm:min-w-90","sm:w-90","sm:rounded-2xl","overflow-y-auto","overflow-hidden","shadow-lg","bg-white","dark:bg-slate-900"],[1,"w-full","px-4","py-4","bg-primary","flex","justify-between","items-center"],[1,"text-white","font-bold","text-lg"],["mat-icon-button","",1,"md:hidden",3,"click"],[1,"text-white"],["mat-icon-button","",3,"click"],[1,"flex","flex-col","w-full","h-full","p-4","form-menu",3,"formGroup"],[1,"font-bold","text-gray-500","text-base","mt-4"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64","mt-2"],["formControlName","activo"],[3,"value"],[1,"fila-naranja",3,"value"],[1,"fila-amarillo",3,"value"],["formControlName","tipo"],[1,"w-full","md:flex","md:justify-between","md:pb-4","md:px-4"],["mat-stroked-button","","color","primary",1,"w-full","rounded-none","md:w-28","md:rounded-3xl","hidden","md:block",3,"click"],[1,"text-gray-700","font-bold"],["mat-raised-button","",1,"w-full","bg-primary","rounded-none","md:w-28","md:rounded-3xl","py-8","md:py-0",3,"click"],[1,"text-white","font-bold"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"span",2),t._uU(3,"Filtros"),t.qZA(),t.TgZ(4,"div")(5,"button",3),t.NdJ("click",function(){return o.resetFilters()}),t.TgZ(6,"mat-icon",4),t._uU(7,"refresh"),t.qZA()(),t.TgZ(8,"button",5),t.NdJ("click",function(){return o.onCloseMenu()}),t.TgZ(9,"mat-icon",4),t._uU(10,"close"),t.qZA()()()(),t.TgZ(11,"form",6)(12,"span",7),t._uU(13,"Activo"),t.qZA(),t.TgZ(14,"mat-form-field",8)(15,"mat-select",9)(16,"mat-option",10),t._uU(17,"Todos"),t.qZA(),t.TgZ(18,"mat-option",11),t._uU(19,"No"),t.qZA(),t.TgZ(20,"mat-option",12),t._uU(21,"Si"),t.qZA()()(),t.TgZ(22,"span",7),t._uU(23,"Tipo Articulo"),t.qZA(),t.TgZ(24,"mat-form-field",8)(25,"mat-select",13)(26,"mat-option",10),t._uU(27,"Todos"),t.qZA(),t.TgZ(28,"mat-option",10),t._uU(29,"Insumo"),t.qZA(),t.TgZ(30,"mat-option",10),t._uU(31,"Producto"),t.qZA(),t.TgZ(32,"mat-option",10),t._uU(33,"Servicio"),t.qZA()()()(),t.TgZ(34,"div",14)(35,"button",15),t.NdJ("click",function(){return o.resetFilters()}),t.TgZ(36,"span",16),t._uU(37,"Limpiar"),t.qZA()(),t.TgZ(38,"button",17),t.NdJ("click",function(){return o.onCloseMenu(o.formFilters.getRawValue())}),t.TgZ(39,"span",18),t._uU(40,"Filtrar"),t.qZA()()()()),2&e&&(t.Q6J("@expandCollapse","expanded"),t.xp6(11),t.Q6J("formGroup",o.formFilters),t.xp6(5),t.Q6J("value",-1),t.xp6(2),t.Q6J("value",0),t.xp6(2),t.Q6J("value",1),t.xp6(6),t.Q6J("value",-1),t.xp6(2),t.Q6J("value",0),t.xp6(2),t.Q6J("value",1),t.xp6(2),t.Q6J("value",2))},dependencies:[f.lW,f.RK,p.KE,v.gD,Z.ey,a._Y,a.JJ,a.JL,a.sg,a.u,h.Hw],data:{animation:bt.L}}),i})();var At=l(7374),Ct=l(8978);let Ut=(()=>{class i{constructor(e,o,n,s,u,I,kt,Jt){this._articulosService=e,this._menuService=o,this.confirm=n,this.alert=s,this.dialogo=u,this._searchService=I,this.router=kt,this._headerTextService=Jt,this.dataSource=new c.by,this.column_params=["codigo_interno","descripcion","descripcion_rubro","descripcion_tipo","activo","acciones"],this.headers=["C\xf3digo Interno","Descripci\xf3n","Rubro","Tipo Articulo","Activo",""],this.funcionesObjeto=null,this.filtroBusqueda="",this.filtersLike=["descripcion","codigo_interno"],this.filter={activo:-1,tipo:-1},this.extraParams="",this.parametrosActualizados=new t.vpe,this.env=d.N.stock.view_articulos+"?",this.search=new a.NI(""),this._headerTextService.setTitulo(this.router),this.funcionesObjeto=[{icono:"edit",nombre_boton:"Editar",functionName:"editar"},{icono:"square_foot",nombre_boton:"Unidad de medida",functionName:"um"},{icono:"delete",nombre_boton:"Eliminar",functionName:"eliminar"}]}ngOnInit(){this.SearchTextSub$=this._searchService.getSearchText().pipe((0,Y.b)(250),(0,O.x)()).subscribe(e=>{this.filtroBusqueda=e,this.tabla.filters(this.filtroBusqueda)}),this.FilterEventSub$=this._searchService.getFilterEvent().subscribe(e=>{this.onFilterMenu(this._searchService.getFilterOrigin())})}onFilterMenu(e){this._menuService.open(Tt,e._elementRef,{filter:this.filter}).afterClosed().subscribe({next:o=>{o&&(this.filter=o,this.extraParams=-1!=this.filter.activo?"filter[activo]="+this.filter.activo:"",this.extraParams=-1!=this.filter.tipo?"filter[tipo]="+this.filter.tipo:"",this.tabla.filters(this.filtroBusqueda))}})}generarAcciones(e){switch(e.name){case"editar":this.updateArticulo(e);break;case"eliminar":this.deleteArticulo(e);break;case"um":this.modalUnidadMedidas(e)}}saveArticulo(){this.dialogo.open(M,{panelClass:"ayuda-dialog"}).afterClosed().subscribe({next:()=>{this.tabla.filters(this.filtroBusqueda)}})}updateArticulo(e){this.dialogo.open(M,{data:e.params.data,panelClass:"my-dialog",autoFocus:!1}).afterClosed().subscribe({next:()=>{this.tabla.filters(this.filtroBusqueda)}})}deleteArticulo(e){this.confirm.open({title:"Eliminar Art\xedculo "+e.params.data.descripcion,message:"\xbfDesea eliminar la Art\xedculo: "+e.params.data.descripcion+"?",dismissible:!1,actions:{confirm:{show:!0,color:"warn",label:"Si"},cancel:{show:!0,label:"No"}}}).afterClosed().subscribe(o=>{"confirmed"===o&&this._articulosService.deleteArticulo(e.params.data.idarticulo).subscribe({next:n=>{this.alert.success("Art\xedculo eliminado con \xe9xito."),o&&this.tabla.renderTabla()},error:n=>{console.error(n),alert("Este Art\xedculo no puede eliminarse. Tiene elementos asociados.")}})})}modalUnidadMedidas(e){this.dialogo.open(Zt,{data:e.params.data,panelClass:"my-dialog",autoFocus:!1}).afterClosed().subscribe({next:o=>{o&&this.tabla.renderTabla()}})}ngOnDestroy(){this._searchService.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(T),t.Y36(w.r),t.Y36(F.R),t.Y36(x.T),t.Y36(g.uw),t.Y36(At.o),t.Y36(C.F0),t.Y36(Ct.k))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-articulos"]],viewQuery:function(e,o){if(1&e&&t.Gf(y.C,5),2&e){let n;t.iGM(n=t.CRH())&&(o.tabla=n.first)}},inputs:{extraParams:"extraParams"},outputs:{parametrosActualizados:"parametrosActualizados"},decls:9,vars:9,consts:[[1,"w-full","flex","flex-col","relative"],[1,"mb-8","mt-2"],[1,"fixed","right-10"],["mat-icon-button","","type","button","matTooltip","Crear Art\xedculo",1,"mr-2","ml-2","bg-blue-500","p-2","rounded-full","z-99999",3,"click"],["save",""],[1,"text-white"],[1,"pr-2","pl-2"],[1,"bottom-10","sm:bottom-0","table-fixed","sm:top-2","w-full","m-0",3,"cache","columnsNames","renderType","columnsParams","endpoint","functions","extraClasses","FiltersLikes","extraParams","functionEmitter"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3,4),t.NdJ("click",function(){return o.saveArticulo()}),t.TgZ(5,"mat-icon",5),t._uU(6,"add"),t.qZA()()()(),t.TgZ(7,"div",6)(8,"app-tabla-dinamica",7),t.NdJ("functionEmitter",function(s){return o.generarAcciones(s)}),t.qZA()()()),2&e&&(t.xp6(8),t.Q6J("cache",!1)("columnsNames",o.headers)("renderType","client")("columnsParams",o.column_params)("endpoint",o.env)("functions",o.funcionesObjeto)("extraClasses","td.mat-cell border,td.mat-cell border-slate-400")("FiltersLikes",o.filtersLike)("extraParams",o.extraParams))},dependencies:[f.RK,h.Hw,S.gM,y.C]}),i})();var wt=l(8995),Nt=l(2611),It=l(3873);const qt=[{path:"",component:Ut}];let St=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({providers:[T,w.r,x.T,_.uU],imports:[_.ez,C.Bz.forChild(qt),c.p0,f.ot,v.LD,p.lN,a.UX,U.c,h.Ps,D.W,S.AV,wt.Bb,Q.g0,J.p9,A.FA,Nt.JX,It.f,C.Bz]}),i})()}}]);