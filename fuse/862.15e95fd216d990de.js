"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[862],{7862:($,M,a)=>{a.r(M),a.d(M,{UnidadesDeMedidaModule:()=>R});var h=a(1531),w=a(4755),e=a(2223),S=a(8372),D=a(1884),x=a(3627),s=a(9401),c=a(5580),u=a(2340),F=a(7579),A=a(3144),N=a(8951);let p=(()=>{class n{constructor(t,i){this.http=t,this._authService=i}getUnidadesDeMedida(t){let i="?";i+="desc"==t?"sort=-descripcion":"sort=descripcion";var d=new F.x;return this.http.get(`${u.N.stock.unidad_medidas}${i}`).subscribe(r=>{this._authService.accessToken=r.token,d.next({list:r.result})}),d.asObservable()}saveUnidadDeMedida(t){return this.http.post(`${u.N.stock.unidad_medidas}`,t)}updateUnidadDeMedida(t){return this.http.put(`${u.N.stock.unidad_medidas}/`+t.idunidadmedida,t)}deleteUnidadDeMedida(t){return this.http.delete(u.N.stock.unidad_medidas+"/"+t)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(A.eN),e.LFG(N.e))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var v=a(6375),l=a(1728),m=a(9114),b=a(787),U=a(1217),T=a(9609),f=a(430);let C=(()=>{class n{constructor(t,i,d,r){this.data=t,this.unidadMedidaService=i,this.alert=d,this.dialogRef=r,this.columns=["nombre","activo","acciones"],this.unidadMedida=this.data?this.data:null,this.title=this.unidadMedida?.idunidadmedida?"Editar unidad de medida":"Nueva unidad de medida"}ngOnInit(){this.newForm()}newForm(){this.form=new s.cw({descripcion:new s.NI(this.unidadMedida?this.unidadMedida.descripcion:"",s.kI.required),activo:new s.NI(this.unidadMedida?this.unidadMedida?.activo?1:0:"")})}onSubmit(){if(!this.form.valid)return this.alert.warning("Revise Los Datos Ingresados");this.unidadMedida={...this.unidadMedida,descripcion:this.form.get("descripcion").value,activo:this.form.get("activo").value},this.unidadMedida.idunidadmedida?this.unidadMedidaService.updateUnidadDeMedida(this.unidadMedida).subscribe({next:t=>{t&&this.onCloseMenu()}}):this.unidadMedidaService.saveUnidadDeMedida(this.unidadMedida).subscribe({next:t=>{t&&this.onCloseMenu()}})}onCloseMenu(){this.dialogRef.close(!1)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c.WI),e.Y36(p),e.Y36(v.T),e.Y36(c.so))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-save-unidades-de-medida"]],decls:24,vars:4,consts:[[1,"fixed","inset-0","sm:static","max-h-screen","sm:inset-auto","flex","flex-col","md:min-w-140","sm:min-w-90","sm:w-90","sm:rounded-2xl","overflow-y-auto","overflow-hidden","bg-white","shadow-sm","dark:bg-slate-900"],[1,"w-full","px-4","py-4","bg-primary","flex","justify-between","items-center"],[1,"text-white","font-bold","text-lg"],["mat-icon-button","",3,"click"],[1,"text-white"],[1,"flex","flex-col","w-full","h-full","p-4","form-menu",3,"formGroup"],["appearance","outline",1,"w-full"],["matInput","","formControlName","descripcion"],["formControlName","activo"],[3,"value"],[1,"w-full","md:flex","justify-center","pb-4","md:px-4"],["mat-raised-button","","color","accent",1,"w-full","bg-primary","rounded-none","md:w-28","md:rounded-3xl","py-8","md:py-0",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"span",2),e._uU(3),e.qZA(),e.TgZ(4,"div")(5,"button",3),e.NdJ("click",function(){return i.onCloseMenu()}),e.TgZ(6,"mat-icon",4),e._uU(7,"close"),e.qZA()()()(),e.TgZ(8,"form",5)(9,"mat-form-field",6)(10,"mat-label"),e._uU(11,"Descripci\xf3n"),e.qZA(),e._UZ(12,"input",7),e.qZA(),e.TgZ(13,"mat-form-field",6)(14,"mat-label"),e._uU(15,"Activo"),e.qZA(),e.TgZ(16,"mat-select",8)(17,"mat-option",9),e._uU(18,"No"),e.qZA(),e.TgZ(19,"mat-option",9),e._uU(20,"Si"),e.qZA()()()(),e.TgZ(21,"div",10)(22,"button",11),e.NdJ("click",function(){return i.onSubmit()}),e._uU(23," Guardar "),e.qZA()()()),2&t&&(e.xp6(3),e.Oqu(i.title),e.xp6(5),e.Q6J("formGroup",i.form),e.xp6(9),e.Q6J("value",0),e.xp6(2),e.Q6J("value",1))},dependencies:[l.lW,l.RK,m.KE,m.hX,b.gD,U.ey,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,T.Nt,f.Hw]}),n})();var Z=a(2018),J=a(8288),g=a(3686);let Y=(()=>{class n{constructor(t,i){this.data=t,this.menuService=i}ngOnInit(){this.formFilters=new s.cw({activo:new s.NI(-1)}),this.formFilters.patchValue(this.data.filter)}resetFilters(){this.formFilters.reset({activo:-1})}onCloseMenu(t=null){this.menuService.close(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36("MENU_DATA"),e.Y36(g.r))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-filter-menu-unidades-de-medida"]],decls:29,vars:5,consts:[[1,"fixed","filtroJeds","inset-0","sm:static","max-h-screen","sm:inset-auto","flex","flex-col","sm:min-w-90","sm:w-90","sm:rounded-2xl","overflow-y-auto","overflow-hidden","shadow-lg","bg-white","dark:bg-slate-900"],[1,"w-full","px-4","py-4","bg-primary","flex","justify-between","items-center"],[1,"text-white","font-bold","text-lg"],["mat-icon-button","",1,"md:hidden",3,"click"],[1,"text-white"],["mat-icon-button","",3,"click"],[1,"flex","flex-col","w-full","h-full","p-4","form-menu",3,"formGroup"],[1,"font-bold","text-gray-500","text-base","mt-4"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64","mt-2"],["formControlName","activo"],[3,"value"],[1,"fila-naranja",3,"value"],[1,"fila-amarillo",3,"value"],[1,"w-full","md:flex","md:justify-between","md:pb-4","md:px-4"],["mat-stroked-button","","color","primary",1,"w-full","rounded-none","md:w-28","md:rounded-3xl","hidden","md:block",3,"click"],[1,"text-gray-700","font-bold"],["mat-raised-button","",1,"w-full","bg-primary","rounded-none","md:w-28","md:rounded-3xl","py-8","md:py-0",3,"click"],[1,"text-white","font-bold"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"span",2),e._uU(3,"Filtros"),e.qZA(),e.TgZ(4,"div")(5,"button",3),e.NdJ("click",function(){return i.resetFilters()}),e.TgZ(6,"mat-icon",4),e._uU(7,"refresh"),e.qZA()(),e.TgZ(8,"button",5),e.NdJ("click",function(){return i.onCloseMenu()}),e.TgZ(9,"mat-icon",4),e._uU(10,"close"),e.qZA()()()(),e.TgZ(11,"form",6)(12,"span",7),e._uU(13,"Activo"),e.qZA(),e.TgZ(14,"mat-form-field",8)(15,"mat-select",9)(16,"mat-option",10),e._uU(17,"Todos"),e.qZA(),e.TgZ(18,"mat-option",11),e._uU(19,"No"),e.qZA(),e.TgZ(20,"mat-option",12),e._uU(21,"Si"),e.qZA()()()(),e.TgZ(22,"div",13)(23,"button",14),e.NdJ("click",function(){return i.resetFilters()}),e.TgZ(24,"span",15),e._uU(25,"Limpiar"),e.qZA()(),e.TgZ(26,"button",16),e.NdJ("click",function(){return i.onCloseMenu(i.formFilters.getRawValue())}),e.TgZ(27,"span",17),e._uU(28,"Filtrar"),e.qZA()()()()),2&t&&(e.Q6J("@expandCollapse","expanded"),e.xp6(11),e.Q6J("formGroup",i.formFilters),e.xp6(5),e.Q6J("value",-1),e.xp6(2),e.Q6J("value",0),e.xp6(2),e.Q6J("value",1))},dependencies:[l.lW,l.RK,m.KE,b.gD,U.ey,s._Y,s.JJ,s.JL,s.sg,s.u,f.Hw],data:{animation:J.L}}),n})();var k=a(1683),j=a(7374),E=a(8978),y=a(3649);let I=(()=>{class n{constructor(t,i,d,r,B,G,z,X){this._unidadesDeMedidaService=t,this.confirm=i,this.alert=d,this.dialogo=r,this._searchService=B,this._menuService=G,this._headerTextService=z,this.router=X,this.dataSource=new x.by,this.headers=["Descripcion","Activo","Acciones"],this.column_params=["descripcion","activo","acciones"],this.funcionesObjeto=null,this.filtroBusqueda="",this.filtersLike=["descripcion"],this.filter={activo:-1},this.extraParams="",this.parametrosActualizados=new e.vpe,this.env=u.N.stock.unidad_medidas+"?",this.search=new s.NI(""),this._headerTextService.setTitulo(this.router),this.funcionesObjeto=[{icono:"edit",nombre_boton:"Editar",functionName:"editar"},{icono:"delete",nombre_boton:"Eliminar",functionName:"eliminar"}]}ngOnInit(){this.SearchTextSub$=this._searchService.getSearchText().pipe((0,S.b)(250),(0,D.x)()).subscribe(t=>{this.filtroBusqueda=t,this.tabla.filters(this.filtroBusqueda)}),this.FilterEventSub$=this._searchService.getFilterEvent().subscribe(t=>{this.onFilterMenu(this._searchService.getFilterOrigin())})}onFilterMenu(t){this._menuService.open(Y,t._elementRef,{filter:this.filter}).afterClosed().subscribe({next:i=>{i&&(this.filter=i,this.extraParams=-1!=this.filter.activo?"filter[activo]="+this.filter.activo:"",this.tabla.filters(this.filtroBusqueda))}})}generarAcciones(t){switch(t.name){case"editar":this.updateUnidadDeMedida(t);break;case"eliminar":this.deleteUnidadDeMedida(t)}}saveUnidadDeMedida(){this.dialogo.open(C,{panelClass:"ayuda-dialog"}).afterClosed().subscribe({next:()=>{this.tabla.filters(this.filtroBusqueda)}})}updateUnidadDeMedida(t){this.dialogo.open(C,{data:t.params.data,panelClass:"my-dialog",autoFocus:!1}).afterClosed().subscribe({next:()=>{this.tabla.filters(this.filtroBusqueda)}})}deleteUnidadDeMedida(t){this.confirm.open({title:"Eliminar Unidad de medida "+t.params.data.descripcion,message:"\xbfDesea eliminar la Unidad de medida: "+t.params.data.descripcion+"?",dismissible:!1,actions:{confirm:{show:!0,color:"warn",label:"Si"},cancel:{show:!0,label:"No"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._unidadesDeMedidaService.deleteUnidadDeMedida(t.params.data.idunidadmedida).subscribe({next:d=>{this.alert.success("Unidad de medida eliminado con \xe9xito."),i&&this.tabla.renderTabla()},error:d=>{console.error(d),alert("Esta Unidad de medida no puede eliminarse. Tiene elementos asociados.")}})})}ngOnDestroy(){this._searchService.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p),e.Y36(k.R),e.Y36(v.T),e.Y36(c.uw),e.Y36(j.o),e.Y36(g.r),e.Y36(E.k),e.Y36(h.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-unidades-de-medida"]],viewQuery:function(t,i){if(1&t&&e.Gf(Z.C,5),2&t){let d;e.iGM(d=e.CRH())&&(i.tabla=d.first)}},inputs:{extraParams:"extraParams"},outputs:{parametrosActualizados:"parametrosActualizados"},decls:9,vars:9,consts:[[1,"w-full","flex","flex-col","relative"],[1,"mb-8","mt-2"],[1,"fixed","right-10"],["mat-icon-button","","type","button","matTooltip","Crear UM",1,"mr-2","ml-2","bg-blue-500","p-2","rounded-full","z-99999",3,"click"],["save",""],[1,"text-white"],[1,"pr-2","pl-2"],[1,"bottom-10","sm:bottom-0","table-fixed","sm:top-2","w-full","m-0",3,"cache","columnsNames","renderType","columnsParams","endpoint","functions","extraClasses","FiltersLikes","extraParams","functionEmitter"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3,4),e.NdJ("click",function(){return i.saveUnidadDeMedida()}),e.TgZ(5,"mat-icon",5),e._uU(6,"add"),e.qZA()()()(),e.TgZ(7,"div",6)(8,"app-tabla-dinamica",7),e.NdJ("functionEmitter",function(r){return i.generarAcciones(r)}),e.qZA()()()),2&t&&(e.xp6(8),e.Q6J("cache",!1)("columnsNames",i.headers)("renderType","client")("columnsParams",i.column_params)("endpoint",i.env)("functions",i.funcionesObjeto)("extraClasses","td.mat-cell border,td.mat-cell border-slate-400")("FiltersLikes",i.filtersLike)("extraParams",i.extraParams))},dependencies:[l.RK,f.Hw,y.gM,Z.C]}),n})();var L=a(5971),Q=a(2611),O=a(3873);const P=[{path:"",component:I}];let R=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[p,g.r,v.T],imports:[w.ez,h.Bz.forChild(P),x.p0,l.ot,c.Is,b.LD,m.lN,s.UX,T.c,f.Ps,L.W,y.AV,Q.JX,O.f,h.Bz]}),n})()}}]);